<h2 style="margin-top:0;">Editar pregunta</h2>

<form hx-post="{% url 'builder:question_update' q.id %}"
      hx-target="#save-status"
      hx-swap="innerHTML">
  {% csrf_token %}

  <label class="ce-label">Texto</label>
  <input class="ce-input" name="text" value="{{ q.text }}" />

  <label class="ce-label" style="margin-top:12px;">Slug</label>
  <input class="ce-input" name="slug" value="{{ q.slug }}" />

  <label class="ce-label" style="margin-top:12px;">Sección</label>
  <select class="ce-input" name="section_id">
    <option value="">— Sin sección —</option>
    {% for s in sections %}
      <option value="{{ s.id }}" {% if q.section_id == s.id %}selected{% endif %}>{{ s.title }}</option>
    {% endfor %}
  </select>

  <label class="ce-label" style="margin-top:12px;">Tipo</label>
  <select class="ce-input" name="field_type">
    <option value="short_text" {% if q.field_type == "short_text" %}selected{% endif %}>Texto corto</option>
    <option value="long_text" {% if q.field_type == "long_text" %}selected{% endif %}>Texto largo</option>
    <option value="integer" {% if q.field_type == "integer" %}selected{% endif %}>Número</option>
    <option value="boolean" {% if q.field_type == "boolean" %}selected{% endif %}>Sí/No</option>
    <option value="choice" {% if q.field_type == "choice" %}selected{% endif %}>Opción única</option>
    <option value="multi_choice" {% if q.field_type == "multi_choice" %}selected{% endif %}>Casillas (varias)</option>
  </select>

  <div style="display:flex; gap:16px; margin-top:12px;">
    <label><input type="checkbox" name="required" {% if q.required %}checked{% endif %}/> Requerida</label>
    <label><input type="checkbox" name="active" {% if q.active %}checked{% endif %}/> Activa</label>
  </div>
  <hr style="margin:18px 0; border:none; border-top:1px solid #eee;">

  <h3 style="margin:0 0 8px 0; font-size:14px;">Contenido encima de esta pregunta</h3>

  <label style="display:flex; gap:8px; align-items:center; margin:8px 0 10px 0;">
    <input type="checkbox" name="pre_hr" {% if pre_hr %}checked{% endif %} />
    Mostrar línea horizontal (HR) encima del texto
  </label>

  <label class="ce-label">Texto encima (opcional)</label>
  <textarea class="ce-input" name="pre_text" rows="4" style="min-height:90px;">{{ pre_text }}</textarea>

  <hr style="margin:18px 0; border:none; border-top:1px solid #eee;">

  <label class="ce-label">Help text (debajo de la pregunta)</label>
  <textarea class="ce-input" name="help_text" rows="4" style="min-height:90px;">{{ help_text_clean }}</textarea>

  <div style="display:flex; gap:10px; margin-top:16px;">
    <button class="ce-btn" type="submit">Guardar</button>

    <button class="ce-btn ce-btn-danger"
            type="button"
            hx-post="{% url 'builder:question_delete' q.id %}"
            hx-target="#question-list"
            hx-swap="innerHTML">
      Eliminar
    </button>
  </div>
</form>

<div id="save-status" class="ce-muted" style="margin-top:10px;"></div>
